ggplot(data = BMP_summary,aes(x = (flow_atten_percent) , y = retention_percent))+
geom_point(aes(color = quadrant), size = 0.5, alpha = 0.4) +
theme_bw(base_size=10) +
scale_color_manual(values = pal2) +
coord_cartesian(xlim = c(-30,110),
ylim = c(-200,100)) +
geom_smooth(method = "lm", se = FALSE) +
geom_text(data = lin_regress, x = 80, y = -85, aes(label = paste(expression("r" ^ 2)), ' = ' , r2))+
#ggtitle(expression(TN)) +
xlab("Water attenuation (%)") +
ylab("Solute retention (%)") +
facet_grid(Species~BMPType) +
geom_hline(yintercept = 0, color = "gray80")+
geom_vline(xintercept = 0, color = "gray80")+
geom_abline(slope = 1, intercept = 0, lty = 2) +
theme(legend.position = 'none', legend.title = element_blank(),
panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
strip.background = element_blank())
# same as plot above but with regression
ggplot(data = BMP_summary,aes(x = (flow_atten_percent) , y = retention_percent))+
geom_point(aes(color = quadrant), size = 0.5, alpha = 0.4) +
theme_bw(base_size=10) +
scale_color_manual(values = pal2) +
coord_cartesian(xlim = c(-30,110),
ylim = c(-200,100)) +
geom_smooth(method = "lm", se = FALSE) +
geom_text(data = lin_regress, x = 80, y = -85, aes(label = paste(expression(r ^ 2)), ' = ' , r2))+
#ggtitle(expression(TN)) +
xlab("Water attenuation (%)") +
ylab("Solute retention (%)") +
facet_grid(Species~BMPType) +
geom_hline(yintercept = 0, color = "gray80")+
geom_vline(xintercept = 0, color = "gray80")+
geom_abline(slope = 1, intercept = 0, lty = 2) +
theme(legend.position = 'none', legend.title = element_blank(),
panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
strip.background = element_blank())
# same as plot above but with regression
ggplot(data = BMP_summary,aes(x = (flow_atten_percent) , y = retention_percent))+
geom_point(aes(color = quadrant), size = 0.5, alpha = 0.4) +
theme_bw(base_size=10) +
scale_color_manual(values = pal2) +
coord_cartesian(xlim = c(-30,110),
ylim = c(-200,100)) +
geom_smooth(method = "lm", se = FALSE) +
geom_text(data = lin_regress, x = 80, y = -85, aes(label = paste0("~r^{2} == ", r2)))+
#ggtitle(expression(TN)) +
xlab("Water attenuation (%)") +
ylab("Solute retention (%)") +
facet_grid(Species~BMPType) +
geom_hline(yintercept = 0, color = "gray80")+
geom_vline(xintercept = 0, color = "gray80")+
geom_abline(slope = 1, intercept = 0, lty = 2) +
theme(legend.position = 'none', legend.title = element_blank(),
panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
strip.background = element_blank())
# same as plot above but with regression
ggplot(data = BMP_summary,aes(x = (flow_atten_percent) , y = retention_percent))+
geom_point(aes(color = quadrant), size = 0.5, alpha = 0.4) +
theme_bw(base_size=10) +
scale_color_manual(values = pal2) +
coord_cartesian(xlim = c(-30,110),
ylim = c(-200,100)) +
geom_smooth(method = "lm", se = FALSE) +
geom_text(data = lin_regress, x = 80, y = -85, aes(label = paste0("~r^{2} == ", r2)),
parse = T)+
#ggtitle(expression(TN)) +
xlab("Water attenuation (%)") +
ylab("Solute retention (%)") +
facet_grid(Species~BMPType) +
geom_hline(yintercept = 0, color = "gray80")+
geom_vline(xintercept = 0, color = "gray80")+
geom_abline(slope = 1, intercept = 0, lty = 2) +
theme(legend.position = 'none', legend.title = element_blank(),
panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
strip.background = element_blank())
# same as plot above but with regression
ggplot(data = BMP_summary,aes(x = (flow_atten_percent) , y = retention_percent))+
geom_point(aes(color = quadrant), size = 0.5, alpha = 0.4) +
theme_bw(base_size=10) +
scale_color_manual(values = pal2) +
coord_cartesian(xlim = c(-30,110),
ylim = c(-200,100)) +
geom_smooth(method = "lm", se = FALSE) +
geom_text(data = lin_regress, x = 80, y = -85, aes(label = paste0("~r^{2} == ", r2)),
size = 6,
parse = T)+
#ggtitle(expression(TN)) +
xlab("Water attenuation (%)") +
ylab("Solute retention (%)") +
facet_grid(Species~BMPType) +
geom_hline(yintercept = 0, color = "gray80")+
geom_vline(xintercept = 0, color = "gray80")+
geom_abline(slope = 1, intercept = 0, lty = 2) +
theme(legend.position = 'none', legend.title = element_blank(),
panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
strip.background = element_blank())
# same as plot above but with regression
ggplot(data = BMP_summary,aes(x = (flow_atten_percent) , y = retention_percent))+
geom_point(aes(color = quadrant), size = 0.5, alpha = 0.4) +
theme_bw(base_size=10) +
scale_color_manual(values = pal2) +
coord_cartesian(xlim = c(-30,110),
ylim = c(-200,100)) +
geom_smooth(method = "lm", se = FALSE) +
geom_text(data = lin_regress, x = 80, y = -85, aes(label = paste0("~r^{2} == ", r2)),
size = 2,
parse = T)+
#ggtitle(expression(TN)) +
xlab("Water attenuation (%)") +
ylab("Solute retention (%)") +
facet_grid(Species~BMPType) +
geom_hline(yintercept = 0, color = "gray80")+
geom_vline(xintercept = 0, color = "gray80")+
geom_abline(slope = 1, intercept = 0, lty = 2) +
theme(legend.position = 'none', legend.title = element_blank(),
panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
strip.background = element_blank())
# same as plot above but with regression
ggplot(data = BMP_summary,aes(x = (flow_atten_percent) , y = retention_percent))+
geom_point(aes(color = quadrant), size = 0.5, alpha = 0.4) +
theme_bw(base_size=10) +
scale_color_manual(values = pal2) +
coord_cartesian(xlim = c(-30,110),
ylim = c(-200,100)) +
geom_smooth(method = "lm", se = FALSE) +
geom_text(data = lin_regress, x = 80, y = -85, aes(label = paste0("~r^{2} == ", r2)),
size = 4,
parse = T)+
#ggtitle(expression(TN)) +
xlab("Water attenuation (%)") +
ylab("Solute retention (%)") +
facet_grid(Species~BMPType) +
geom_hline(yintercept = 0, color = "gray80")+
geom_vline(xintercept = 0, color = "gray80")+
geom_abline(slope = 1, intercept = 0, lty = 2) +
theme(legend.position = 'none', legend.title = element_blank(),
panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
strip.background = element_blank())
# same as plot above but with regression
ggplot(data = BMP_summary,aes(x = (flow_atten_percent) , y = retention_percent))+
geom_point(aes(color = quadrant), size = 0.5, alpha = 0.4) +
theme_bw(base_size=10) +
scale_color_manual(values = pal2) +
coord_cartesian(xlim = c(-30,110),
ylim = c(-200,100)) +
geom_smooth(method = "lm", se = FALSE) +
geom_text(data = lin_regress, x = 80, y = -85, aes(label = paste0("~r^{2} == ", r2)),
size = 3,
parse = T)+
#ggtitle(expression(TN)) +
xlab("Water attenuation (%)") +
ylab("Solute retention (%)") +
facet_grid(Species~BMPType) +
geom_hline(yintercept = 0, color = "gray80")+
geom_vline(xintercept = 0, color = "gray80")+
geom_abline(slope = 1, intercept = 0, lty = 2) +
theme(legend.position = 'none', legend.title = element_blank(),
panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
strip.background = element_blank())
# same as plot above but with regression
ggplot(data = BMP_summary,aes(x = (flow_atten_percent) , y = retention_percent))+
geom_point(aes(color = quadrant), size = 0.5, alpha = 0.4) +
theme_bw(base_size=10) +
scale_color_manual(values = pal2) +
coord_cartesian(xlim = c(-30,110),
ylim = c(-200,100)) +
geom_smooth(method = "lm", se = FALSE) +
geom_text(data = lin_regress, x = 80, y = -85, aes(label = paste0("~r^{2} == ", r2)),
size = 3,
parse = T)+
geom_text(data = lin_regress, x = 80, y = -90, aes(label = paste0("slope = ", slope)),
size = 3)+
#ggtitle(expression(TN)) +
xlab("Water attenuation (%)") +
ylab("Solute retention (%)") +
facet_grid(Species~BMPType) +
geom_hline(yintercept = 0, color = "gray80")+
geom_vline(xintercept = 0, color = "gray80")+
geom_abline(slope = 1, intercept = 0, lty = 2) +
theme(legend.position = 'none', legend.title = element_blank(),
panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
strip.background = element_blank())
# same as plot above but with regression
ggplot(data = BMP_summary,aes(x = (flow_atten_percent) , y = retention_percent))+
geom_point(aes(color = quadrant), size = 0.5, alpha = 0.4) +
theme_bw(base_size=10) +
scale_color_manual(values = pal2) +
coord_cartesian(xlim = c(-30,110),
ylim = c(-200,100)) +
geom_smooth(method = "lm", se = FALSE) +
geom_text(data = lin_regress, x = 80, y = -85, aes(label = paste0("~r^{2} == ", r2)),
size = 3,
parse = T)+
geom_text(data = lin_regress, x = 80, y = -110, aes(label = paste0("slope = ", slope)),
size = 3)+
#ggtitle(expression(TN)) +
xlab("Water attenuation (%)") +
ylab("Solute retention (%)") +
facet_grid(Species~BMPType) +
geom_hline(yintercept = 0, color = "gray80")+
geom_vline(xintercept = 0, color = "gray80")+
geom_abline(slope = 1, intercept = 0, lty = 2) +
theme(legend.position = 'none', legend.title = element_blank(),
panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
strip.background = element_blank())
# same as plot above but with regression
ggplot(data = BMP_summary,aes(x = (flow_atten_percent) , y = retention_percent))+
geom_point(aes(color = quadrant), size = 0.5, alpha = 0.4) +
theme_bw(base_size=10) +
scale_color_manual(values = pal2) +
coord_cartesian(xlim = c(-30,110),
ylim = c(-200,100)) +
geom_smooth(method = "lm", se = FALSE) +
geom_text(data = lin_regress, x = 80, y = -85, aes(label = paste0("~r^{2} == ", r2)),
size = 3,
parse = T)+
geom_text(data = lin_regress, x = 70, y = -120, aes(label = paste0("slope = ", slope)),
size = 3)+
#ggtitle(expression(TN)) +
xlab("Water attenuation (%)") +
ylab("Solute retention (%)") +
facet_grid(Species~BMPType) +
geom_hline(yintercept = 0, color = "gray80")+
geom_vline(xintercept = 0, color = "gray80")+
geom_abline(slope = 1, intercept = 0, lty = 2) +
theme(legend.position = 'none', legend.title = element_blank(),
panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
strip.background = element_blank())
(p.value  <= 0.05) ~ '<0.05')
# Calculate linear regressions and plot onto facet plot --------------------------------
# linear regression
lin_regress <- BMP_summary %>%
group_by(BMPType, Species) %>%
do(model = lm(retention_percent ~ flow_atten_percent, data = .)) %>%
mutate(slope = round(model$coefficients[2],3),
r2    = round(summary(model)$r.squared,3),
p.value = round(summary(model)$coefficients[2,4],5)
) %>%
mutate(p_class = case_when((p.value > 0.05 ) ~ 'N.S.',
(p.value  <= 0.05) ~ '<0.05'))
# same as plot above but with regression
ggplot(data = BMP_summary,aes(x = (flow_atten_percent) , y = retention_percent))+
geom_point(aes(color = quadrant), size = 0.5, alpha = 0.4) +
theme_bw(base_size=10) +
scale_color_manual(values = pal2) +
coord_cartesian(xlim = c(-30,110),
ylim = c(-200,100)) +
geom_smooth(method = "lm", se = FALSE) +
geom_text(data = lin_regress, x = 80, y = -85, aes(label = paste0("~r^{2} == ", r2)),
size = 3,
parse = T)+
geom_text(data = lin_regress, x = 70, y = -120, aes(label = paste0("slope = ", slope)),
size = 3)+
#ggtitle(expression(TN)) +
xlab("Water attenuation (%)") +
ylab("Solute retention (%)") +
facet_grid(Species~BMPType) +
geom_hline(yintercept = 0, color = "gray80")+
geom_vline(xintercept = 0, color = "gray80")+
geom_abline(slope = 1, intercept = 0, lty = 2) +
theme(legend.position = 'none', legend.title = element_blank(),
panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
strip.background = element_blank())
# same as plot above but with regression
ggplot(data = BMP_summary,aes(x = (flow_atten_percent) , y = retention_percent))+
geom_point(aes(color = quadrant), size = 0.5, alpha = 0.4) +
theme_bw(base_size=10) +
scale_color_manual(values = pal2) +
coord_cartesian(xlim = c(-30,110),
ylim = c(-200,100)) +
geom_smooth(method = "lm", se = FALSE) +
geom_text(data = lin_regress, x = 80, y = -85, aes(label = paste0("~r^{2} == ", r2)),
size = 3,
parse = T)+
geom_text(data = lin_regress, x = 70, y = -120, aes(label = paste0("slope = ", slope)),
size = 3)+
geom_text(data = lin_regress, x = 70, y = -1650, aes(label = p_class),
size = 3)+
#ggtitle(expression(TN)) +
xlab("Water attenuation (%)") +
ylab("Solute retention (%)") +
facet_grid(Species~BMPType) +
geom_hline(yintercept = 0, color = "gray80")+
geom_vline(xintercept = 0, color = "gray80")+
geom_abline(slope = 1, intercept = 0, lty = 2) +
theme(legend.position = 'none', legend.title = element_blank(),
panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
strip.background = element_blank())
# same as plot above but with regression
ggplot(data = BMP_summary,aes(x = (flow_atten_percent) , y = retention_percent))+
geom_point(aes(color = quadrant), size = 0.5, alpha = 0.4) +
theme_bw(base_size=10) +
scale_color_manual(values = pal2) +
coord_cartesian(xlim = c(-30,110),
ylim = c(-200,100)) +
geom_smooth(method = "lm", se = FALSE) +
geom_text(data = lin_regress, x = 80, y = -85, aes(label = paste0("~r^{2} == ", r2)),
size = 3,
parse = T)+
geom_text(data = lin_regress, x = 70, y = -120, aes(label = paste0("slope = ", slope)),
size = 3)+
geom_text(data = lin_regress, x = 70, y = -165, aes(label = p_class),
size = 3)+
#ggtitle(expression(TN)) +
xlab("Water attenuation (%)") +
ylab("Solute retention (%)") +
facet_grid(Species~BMPType) +
geom_hline(yintercept = 0, color = "gray80")+
geom_vline(xintercept = 0, color = "gray80")+
geom_abline(slope = 1, intercept = 0, lty = 2) +
theme(legend.position = 'none', legend.title = element_blank(),
panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
strip.background = element_blank())
# same as plot above but with regression
ggplot(data = BMP_summary,aes(x = (flow_atten_percent) , y = retention_percent))+
geom_point(aes(color = quadrant), size = 0.5, alpha = 0.4) +
theme_bw(base_size=10) +
scale_color_manual(values = pal2) +
coord_cartesian(xlim = c(-30,110),
ylim = c(-200,100)) +
geom_smooth(method = "lm", se = FALSE) +
geom_text(data = lin_regress, x = 80, y = -85, aes(label = paste0("~r^{2} == ", r2)),
size = 3,
parse = T)+
geom_text(data = lin_regress, x = 70, y = -120, aes(label = paste0("slope = ", slope)),
size = 3)+
geom_text(data = lin_regress, x = 70, y = -160, aes(label = p_class),
size = 3)+
#ggtitle(expression(TN)) +
xlab("Water attenuation (%)") +
ylab("Solute retention (%)") +
facet_grid(Species~BMPType) +
geom_hline(yintercept = 0, color = "gray80")+
geom_vline(xintercept = 0, color = "gray80")+
geom_abline(slope = 1, intercept = 0, lty = 2) +
theme(legend.position = 'none', legend.title = element_blank(),
panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
strip.background = element_blank())
# same as plot above but with regression
ggplot(data = BMP_summary,aes(x = (flow_atten_percent) , y = retention_percent))+
geom_point(aes(color = quadrant), size = 0.5, alpha = 0.4) +
theme_bw(base_size=10) +
scale_color_manual(values = pal2) +
coord_cartesian(xlim = c(-30,110),
ylim = c(-200,100)) +
geom_smooth(method = "lm", se = FALSE) +
geom_text(data = lin_regress, x = 80, y = -85, aes(label = paste0("~r^{2} == ", r2)),
size = 3,
parse = T)+
geom_text(data = lin_regress, x = 70, y = -120, aes(label = paste0("slope = ", slope)),
size = 3)+
geom_text(data = lin_regress, x = 70, y = -160, aes(label = paste0("p ", p_class)),
size = 3)+
#ggtitle(expression(TN)) +
xlab("Water attenuation (%)") +
ylab("Solute retention (%)") +
facet_grid(Species~BMPType) +
geom_hline(yintercept = 0, color = "gray80")+
geom_vline(xintercept = 0, color = "gray80")+
geom_abline(slope = 1, intercept = 0, lty = 2) +
theme(legend.position = 'none', legend.title = element_blank(),
panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
strip.background = element_blank())
# Calculate linear regressions and plot onto facet plot --------------------------------
# linear regression
lin_regress <- BMP_summary %>%
group_by(BMPType, Species) %>%
do(model = lm(retention_percent ~ flow_atten_percent, data = .)) %>%
mutate(slope = round(model$coefficients[2],3),
r2    = round(summary(model)$r.squared,3),
p.value = round(summary(model)$coefficients[2,4],5)
) %>%
mutate(p_class = case_when((p.value > 0.05 ) ~ 'N.S.',
(p.value  <= 0.05) ~ 'p <0.05'))
# same as plot above but with regression
ggplot(data = BMP_summary,aes(x = (flow_atten_percent) , y = retention_percent))+
geom_point(aes(color = quadrant), size = 0.5, alpha = 0.4) +
theme_bw(base_size=10) +
scale_color_manual(values = pal2) +
coord_cartesian(xlim = c(-30,110),
ylim = c(-200,100)) +
geom_smooth(method = "lm", se = FALSE) +
geom_text(data = lin_regress, x = 80, y = -85, aes(label = paste0("~r^{2} == ", r2)),
size = 3,
parse = T)+
geom_text(data = lin_regress, x = 70, y = -120, aes(label = paste0("slope = ", slope)),
size = 3)+
geom_text(data = lin_regress, x = 70, y = -160, aes(label = p_ckass),
size = 3)+
#ggtitle(expression(TN)) +
xlab("Water attenuation (%)") +
ylab("Solute retention (%)") +
facet_grid(Species~BMPType) +
geom_hline(yintercept = 0, color = "gray80")+
geom_vline(xintercept = 0, color = "gray80")+
geom_abline(slope = 1, intercept = 0, lty = 2) +
theme(legend.position = 'none', legend.title = element_blank(),
panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
strip.background = element_blank())
# same as plot above but with regression
ggplot(data = BMP_summary,aes(x = (flow_atten_percent) , y = retention_percent))+
geom_point(aes(color = quadrant), size = 0.5, alpha = 0.4) +
theme_bw(base_size=10) +
scale_color_manual(values = pal2) +
coord_cartesian(xlim = c(-30,110),
ylim = c(-200,100)) +
geom_smooth(method = "lm", se = FALSE) +
geom_text(data = lin_regress, x = 80, y = -85, aes(label = paste0("~r^{2} == ", r2)),
size = 3,
parse = T)+
geom_text(data = lin_regress, x = 70, y = -120, aes(label = paste0("slope = ", slope)),
size = 3)+
geom_text(data = lin_regress, x = 70, y = -160, aes(label = p_class),
size = 3)+
#ggtitle(expression(TN)) +
xlab("Water attenuation (%)") +
ylab("Solute retention (%)") +
facet_grid(Species~BMPType) +
geom_hline(yintercept = 0, color = "gray80")+
geom_vline(xintercept = 0, color = "gray80")+
geom_abline(slope = 1, intercept = 0, lty = 2) +
theme(legend.position = 'none', legend.title = element_blank(),
panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
strip.background = element_blank())
# same as plot above but with regression
ggplot(data = BMP_summary,aes(x = (flow_atten_percent) , y = retention_percent))+
geom_point(aes(color = quadrant), size = 0.5, alpha = 0.4) +
theme_bw(base_size=10) +
scale_color_manual(values = pal2) +
coord_cartesian(xlim = c(-30,110),
ylim = c(-200,100)) +
geom_smooth(method = "lm", se = FALSE) +
geom_text(data = lin_regress, x = 80, y = -85, aes(label = paste0("~r^{2} == ", r2)),
size = 3,
parse = T)+
geom_text(data = lin_regress, x = 70, y = -120, aes(label = paste0("slope = ", slope)),
size = 3)+
geom_text(data = lin_regress, x = 80, y = -160, aes(label = p_class),
size = 3)+
#ggtitle(expression(TN)) +
xlab("Water attenuation (%)") +
ylab("Solute retention (%)") +
facet_grid(Species~BMPType) +
geom_hline(yintercept = 0, color = "gray80")+
geom_vline(xintercept = 0, color = "gray80")+
geom_abline(slope = 1, intercept = 0, lty = 2) +
theme(legend.position = 'none', legend.title = element_blank(),
panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
strip.background = element_blank())
# same as plot above but with regression
ggplot(data = BMP_summary,aes(x = (flow_atten_percent) , y = retention_percent))+
geom_point(aes(color = quadrant), size = 0.5, alpha = 0.4) +
theme_bw(base_size=10) +
scale_color_manual(values = pal2) +
coord_cartesian(xlim = c(-30,110),
ylim = c(-200,100)) +
geom_smooth(method = "lm", se = FALSE) +
geom_text(data = lin_regress, x = 80, y = -85, aes(label = paste0("~r^{2} == ", r2)),
size = 3,
parse = T)+
geom_text(data = lin_regress, x = 70, y = -120, aes(label = paste0("slope = ", slope)),
size = 3)+
geom_text(data = lin_regress, x = 80, y = -155, aes(label = p_class),
size = 3)+
#ggtitle(expression(TN)) +
xlab("Water attenuation (%)") +
ylab("Solute retention (%)") +
facet_grid(Species~BMPType) +
geom_hline(yintercept = 0, color = "gray80")+
geom_vline(xintercept = 0, color = "gray80")+
geom_abline(slope = 1, intercept = 0, lty = 2) +
theme(legend.position = 'none', legend.title = element_blank(),
panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
strip.background = element_blank())
# Scatter plot grid, faceted
main_plot <- ggplot(data = BMP_summary,aes(x = (flow_atten_percent) , y = retention_percent))+
geom_point(aes(color = quadrant), size = 0.5, alpha = 0.4) +
theme_bw(base_size=10) +
scale_color_manual(values = pal2) +
coord_cartesian(xlim = c(-30,110),
ylim = c(-200,100)) +
#ggtitle(expression(TN)) +
xlab("Water attenuation (%)") +
ylab("Solute retention (%)") +
facet_grid(Species~BMPType) +
geom_hline(yintercept = 0, color = "gray80")+
geom_vline(xintercept = 0, color = "gray80")+
geom_abline(slope = 1, intercept = 0, lty = 2) +
theme(legend.position = 'none', legend.title = element_blank(),
panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
strip.background = element_blank())
main_plot
# Scatter plot grid, faceted
main_plot <- ggplot(data = BMP_summary,aes(x = (flow_atten_percent) , y = retention_percent))+
geom_point(aes(color = quadrant), size = 0.5, alpha = 0.4) +
theme_bw(base_size=10) +
scale_color_manual(values = pal2) +
coord_cartesian(xlim = c(-30,110),
ylim = c(-200,100)) +
#ggtitle(expression(TN)) +
xlab("Water attenuation (%)") +
ylab("Solute retention (%)") +
facet_grid(Species~BMPType) +
geom_hline(yintercept = 0, color = "gray80")+
geom_vline(xintercept = 0, color = "gray80")+
geom_abline(slope = 1, intercept = 0, lty = 2, color = 'gray80') +
theme(legend.position = 'none', legend.title = element_blank(),
panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
strip.background = element_blank())
main_plot
View(lin_regress)
